# Escenarios de tests - LoadCatalog

| Caso de test                       | Escenario                           | Setup (mocks)                                                               | Entrada    | Comportamiento esperado     | Resultado                                   |
| ---------------------------------- | ----------------------------------- | --------------------------------------------------------------------------- | ---------- | --------------------------- | ------------------------------------------- |
| load_catalog_happy_path            | Archivo válido con items válidos    | FileReader retorna items, Normalizer retorna normalizados, Repo acepta save | `file.csv` | Orquesta todo correctamente | `save(catalog)` llamado 1 vez               |
| load_catalog_empty_file            | Archivo leído sin items             | FileReader retorna `[]`                                                     | `file.csv` | Valida input vacío          | `EmptyCatalogFileException`                 |
| load_catalog_normalizer_fails      | Normalizer detecta error de usuario | Normalizer lanza `CatalogNormalizationException`                            | `file.csv` | Propaga excepción           | Excepción se propaga                        |
| load_catalog_unsupported_source    | Extensión inválida                  | FileReader OK                                                               | `file.txt` | Valida source               | `UnsupportedCatalogSourceException`         |
| load_catalog_batches_items         | Más items que `_BATCH_SIZE`         | Normalizer retorna >50 items                                                | `file.csv` | Usa batching                | `add_or_update_items_batch` llamado N veces |
| load_catalog_calls_reader_once     | Lectura de archivo                  | Mock FileReader                                                             | `file.csv` | Lee una sola vez            | `read_catalog` called once                  |
| load_catalog_calls_normalizer_once | Normalización                       | Mock Normalizer                                                             | `file.csv` | Normaliza una vez           | `normalize_catalog_items` called once       |
| load_catalog_persists_once         | Persistencia final                  | Mock Repo                                                                   | `file.csv` | Persiste una vez            | `save` called once                          |
| load_catalog_does_not_return_value | Contrato void                       | Setup normal                                                                | `file.csv` | No retorna datos            | `None`                                      |
