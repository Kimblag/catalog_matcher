# Escenarios de tests – VectorRepositoryFAISS

| Caso de test                                 | Escenario                                    | Setup (mocks / fixtures)                        | Entrada                       | Comportamiento esperado                                | Resultado esperado                                  |
| ------------------------------------------- | -------------------------------------------- | ------------------------------------------------ | ----------------------------- | ------------------------------------------------------ | --------------------------------------------------- |
| load_index_when_file_exists_should_load      | Archivo index previo existe                  | Crear archivo FAISS dummy                        | path con index existente      | Se lee el index desde disco                             | index cargado igual a guardado                     |
| load_index_when_file_not_exists_should_create | Archivo index no existe                      | Ningún archivo                                  | path no existente             | Crea un nuevo IndexFlatL2                               | index.dimension == dimension                        |
| save_should_add_embeddings_and_persist       | Guardar embeddings                           | index vacío                                     | lista de items con "embedding"| Embeddings agregados al index y escrito en disco      | index.ntotal == len(items) y archivo existe        |
| save_with_empty_list_should_do_nothing       | Guardar lista vacía                          | index con datos previos                          | []                            | No hace nada                                           | index.ntotal sin cambios                             |
| search_should_return_top_k_results           | Buscar embedding                             | index con embeddings previos                     | vector de dimensión correcta  | Busca los vecinos más cercanos                         | lista de tuplas (str(idx), float(dist))           |
| search_with_wrong_dimension_should_raise     | Vector de dimensión incorrecta               | index con dimensión N                             | vector incorrecto             | Valida dimensión                                         | ValueError                                         |
