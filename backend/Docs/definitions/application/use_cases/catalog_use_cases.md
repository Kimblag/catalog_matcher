# Casos de uso - Catálogo

| Use case               | Intención del usuario                                 | Entrada                                   | Proceso principal (Application)                                                                                                                                     | Dominio involucrado                                             | Salida                                     |
| ---------------------- | ----------------------------------------------------- | ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- | ------------------------------------------ |
| **UpsertCatalog**      | Agregar o actualizar ítems en el catálogo            | Archivo CSV / Excel                       | - Leer archivo<br>- Validar estructura<br>- Normalizar datos<br>- Crear o actualizar catálogo en memoria<br>- Persistir cambios                                       | `Catalog.add_or_update_item(...)` / `Catalog.batch_upsert(...)` | Catálogo extendido y actualizado           |
| **DeactivateCatalogItem** | Dar de baja un ítem del catálogo                     | ItemId                                    | - Buscar ítem<br>- Llamar a `deactivate_item`                                                                                                                      | `Catalog.deactivate_item(...)`                                   | Ítem desactivado                           |
| **GetCatalogInfo**     | Ver metadatos del catálogo                            | —                                         | - Obtener catálogo persistido                                                                                                                                       | `Catalog.version`<br>`Catalog.last_updated`<br>`Catalog.source` | Versión, última actualización, source      |
| **ListCatalogItems**   | Ver y consultar los ítems del catálogo                | Filtros opcionales                        | - Obtener ítems<br>- Aplicar filtros / búsqueda                                                                                                                     | `Catalog.items`                                                 | Lista de ítems                             |
| **UpdateCatalogItem**  | Modificar un ítem específico manualmente              | ItemId + campos editables                 | - Validar entrada<br>- Delegar modificación                                                                                                                         | Métodos de comportamiento del `Item`                            | Ítem actualizado                           |
| **MatchRequirements**  | Obtener coincidencias entre requerimientos y catálogo | Archivo de requerimientos + `max_matches` | - Leer archivo<br>- Normalizar requerimientos<br>- Preparar contexto<br>- Invocar IA<br>- Postprocesar resultados                                                   | Catálogo como fuente de verdad                                  | Requerimientos con matches y justificación |


## Excepciones

## Excepciones (Application Layer)

| Excepción                           | Hereda de                   | Cuándo se lanza                                                                 | Responsabilidad real                          | Observaciones críticas                                                                 |
| ---------------------------------- | --------------------------- | ------------------------------------------------------------------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------- |
| EmptyCatalogFileException          | ApplicationLayerException   | El archivo fue leído correctamente pero no contiene ningún ítem                 | Validación de uso del sistema                 | Error 4xx. El usuario cargó un catálogo vacío                                          |
| UnsupportedCatalogSourceException  | ApplicationLayerException   | La extensión del archivo no corresponde a una fuente soportada                  | Validación de entrada                         | Error 4xx. No depende de infra                                                         |
| CatalogNormalizationException      | ApplicationLayerException   | Los datos no cumplen estructura, tipos o reglas mínimas esperadas               | Validación semántica del input                | Error 4xx. El normalizer **es application**, no infra                                   |